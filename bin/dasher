#!/usr/bin/env ruby

module Dash
  module Builtins
    def foo(args)
      puts "FOO"
    end
    module_function :foo

    def true(args)
      return 0
    end
    module_function :true

    alias_method ":", :true
    module_function ":"

    def false(args)
      return 1
    end
    module_function :false

    def exit(args)
      if args.length > 1 then
        super(args[1].to_i)
      else
        super()
      end
    end
    module_function :exit

    def __dot(args)
      if args.length > 1 then
        fullname = Dash.find_dot_file(args[1])
        Dash.setinputfile(fullname, Dash::INPUT_PUSH_FILE)
        Dash.setcommandname(fullname)
        Dash.cmdloop(0)
        Dash.popfile()
        return Dash.exitstatus()
      else
        return 0
      end
    end

    alias_method ".", :__dot
    module_function "."
  end
end

require 'dash/dash'

args = [$0]
args.concat(ARGV)

exit Dash.main(*args)

